# Wazuh Dashboard Configuration
# The 4.14.3 image does not include opensearch_dashboards.yml by default.
# This ConfigMap provides the required configuration.
apiVersion: v1
kind: ConfigMap
metadata:
  name: wazuh-dashboard-config
  namespace: wazuh
  labels:
    app: wazuh-dashboard
data:
  opensearch_dashboards.yml: |
    server.host: "0.0.0.0"
    server.port: 5601
    server.ssl.enabled: true
    server.ssl.key: /usr/share/wazuh-dashboard/config/certs/dashboard-key.pem
    server.ssl.certificate: /usr/share/wazuh-dashboard/config/certs/dashboard.pem
    server.ssl.certificateAuthorities: ["/usr/share/wazuh-dashboard/config/certs/root-ca.pem"]

    # OpenSearch connection â€” shared cluster
    # Credentials are injected via keystore by the entrypoint script
    # using DASHBOARD_USERNAME / DASHBOARD_PASSWORD env vars
    opensearch.hosts: ["https://opensearch-cluster-master.shared.svc.cluster.local:9200"]
    opensearch.ssl.verificationMode: none
    opensearch.requestHeadersAllowlist: ["securitytenant", "Authorization"]

    # Security plugin
    opensearch_security.multitenancy.enabled: false
    opensearch_security.readonly_mode.roles: ["kibana_read_only"]

    # Wazuh plugin paths
    uiSettings.overrides.defaultRoute: /app/wazuh
